'use client'\n\nimport { useState } from 'react'\nimport { useRouter } from 'next/navigation'\nimport { ConnectButton } from '@rainbow-me/rainbowkit'\nimport { Button } from '@/components/ui/button'\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Shield, Upload, Link2, ArrowLeft, FileImage, Video, Sparkles, Zap } from 'lucide-react'\nimport Link from 'next/link'\nimport { ContentMetadata, SocialMetrics } from '@/types'\nimport { ContentScorer } from '@/lib/scoring'\n\nexport default function UploadPage() {\n  const router = useRouter()\n  const [contentType, setContentType] = useState<'file' | 'social-link' | null>(null)\n  const [file, setFile] = useState<File | null>(null)\n  const [socialUrl, setSocialUrl] = useState('')\n  const [title, setTitle] = useState('')\n  const [description, setDescription] = useState('')\n  const [isProcessing, setIsProcessing] = useState(false)\n\n  // æ¨¡æ‹Ÿç¤¾äº¤åª’ä½“æ•°æ®è§£æ\n  const handleSocialUrlSubmit = () => {\n    if (!socialUrl.trim()) return\n    \n    // è¿™é‡Œåº”è¯¥è°ƒç”¨APIè§£æç¤¾äº¤åª’ä½“é“¾æ¥\n    // ç°åœ¨ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®\n    const mockMetrics: SocialMetrics = {\n      followers: 50000,\n      views: 120000,\n      likes: 8500,\n      comments: 320,\n      shares: 180,\n      platform: 'tiktok'\n    }\n    \n    const score = ContentScorer.calculateScore(mockMetrics)\n    const grade = ContentScorer.getScoreGrade(score)\n    \n    // è·³è½¬åˆ°æˆæƒè®¾ç½®é¡µé¢ï¼Œæºå¸¦æ•°æ®\n    const queryParams = new URLSearchParams({\n      contentType: 'social-link',\n      socialUrl,\n      title: title || 'æ¥è‡ªç¤¾äº¤åª’ä½“çš„å†…å®¹',\n      description: description || '',\n      score: score.toString(),\n      grade: grade.grade\n    })\n    \n    router.push(`/license?${queryParams.toString()}`)\n  }\n\n  const handleFileUpload = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const selectedFile = event.target.files?.[0]\n    if (selectedFile) {\n      setFile(selectedFile)\n      if (!title) {\n        setTitle(selectedFile.name)\n      }\n    }\n  }\n\n  const handleFileSubmit = () => {\n    if (!file || !title.trim()) return\n    \n    setIsProcessing(true)\n    \n    // æ¨¡æ‹Ÿæ–‡ä»¶å¤„ç†å’Œè¯„åˆ†\n    setTimeout(() => {\n      // æ–‡ä»¶ä¸Šä¼ é€šå¸¸æœ‰åŸºç¡€åˆ†æ•°\n      const baseScore = Math.floor(Math.random() * 30) + 20 // 20-50åˆ†\n      const grade = ContentScorer.getScoreGrade(baseScore)\n      \n      const queryParams = new URLSearchParams({\n        contentType: 'file',\n        fileName: file.name,\n        title,\n        description: description || '',\n        score: baseScore.toString(),\n        grade: grade.grade\n      })\n      \n      router.push(`/license?${queryParams.toString()}`)\n    }, 2000)\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-indigo-900 relative overflow-hidden\">\n      {/* Background effects */}\n      <div className=\"absolute inset-0\">\n        <div className=\"absolute inset-0\" style={{\n          backgroundImage: `\n            linear-gradient(rgba(59, 130, 246, 0.05) 1px, transparent 1px),\n            linear-gradient(90deg, rgba(59, 130, 246, 0.05) 1px, transparent 1px)\n          `,\n          backgroundSize: '60px 60px'\n        }}></div>\n        \n        {/* Floating particles */}\n        {[...Array(15)].map((_, i) => (\n          <div\n            key={i}\n            className=\"absolute w-1 h-1 bg-blue-400 rounded-full opacity-20 animate-float\"\n            style={{\n              left: `${Math.random() * 100}%`,\n              top: `${Math.random() * 100}%`,\n              animationDelay: `${Math.random() * 5}s`,\n              animationDuration: `${4 + Math.random() * 2}s`\n            }}\n          ></div>\n        ))}\n      </div>\n\n      <header className=\"relative z-10 bg-slate-900/95 backdrop-blur-md border-b border-blue-500/20\">\n        <div className=\"container mx-auto px-6 py-4\">\n          <nav className=\"flex items-center justify-between\">\n            <div className=\"flex items-center space-x-4\">\n              <Link href=\"/\">\n                <Button variant=\"ghost\" className=\"text-blue-300 hover:text-white hover:bg-slate-700/50\">\n                  <ArrowLeft className=\"h-4 w-4 mr-2\" />\n                  è¿”å›é¦–é¡µ\n                </Button>\n              </Link>\n              <div className=\"flex items-center space-x-3\">\n                <div className=\"relative\">\n                  <div className=\"flex items-center justify-center w-10 h-10 bg-gradient-to-r from-blue-600 to-cyan-600 rounded-xl shadow-lg\">\n                    <Shield className=\"w-6 h-6 text-white\" />\n                  </div>\n                  <div className=\"absolute inset-0 bg-gradient-to-r from-blue-600 to-cyan-600 rounded-xl blur opacity-30 animate-pulse\"></div>\n                </div>\n                <div>\n                  <span className=\"text-xl font-bold text-white\">å†…å®¹ä¸Šä¼ </span>\n                  <div className=\"text-xs text-blue-400\">Data Asset Upload</div>\n                </div>\n              </div>\n            </div>\n            <ConnectButton />\n          </nav>\n        </div>\n      </header>\n\n      <main className=\"relative z-10 container mx-auto px-6 py-12\">\n        <div className=\"max-w-4xl mx-auto\">\n          {/* Header section */}\n          <div className=\"text-center mb-12\">\n            <div className=\"inline-flex items-center px-4 py-2 bg-blue-500/10 backdrop-blur-sm rounded-full border border-blue-500/20 shadow-lg mb-6\">\n              <Sparkles className=\"w-4 h-4 text-blue-400 mr-2\" />\n              <span className=\"text-sm font-medium text-blue-300\">å†…å®¹èµ„äº§åŒ–</span>\n            </div>\n            \n            <h1 className=\"text-4xl sm:text-5xl font-bold text-white mb-6\">\n              ä¸Šä¼ ä½ çš„\n              <span className=\"text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-cyan-400 ml-2\">\n                æ•°å­—èµ„äº§\n              </span>\n            </h1>\n            <p className=\"text-xl text-blue-200/80 max-w-2xl mx-auto\">\n              é€‰æ‹©ä¸Šä¼ æ–‡ä»¶æˆ–è¾“å…¥ç¤¾äº¤åª’ä½“é“¾æ¥ï¼Œå°†åˆ›ä½œè½¬åŒ–ä¸ºå¯ç¼–ç¨‹çš„æ•°å­—èµ„äº§\n            </p>\n          </div>\n\n          {!contentType ? (\n            <div className=\"grid md:grid-cols-2 gap-8\">\n              <div \n                className=\"group relative bg-slate-800/50 backdrop-blur-sm border border-blue-500/20 rounded-2xl p-8 hover:border-blue-400/40 transition-all duration-500 hover:scale-105 cursor-pointer\"\n                onClick={() => setContentType('file')}\n              >\n                {/* Glow effect */}\n                <div className=\"absolute inset-0 bg-gradient-to-r from-purple-500/10 to-pink-500/10 opacity-0 group-hover:opacity-100 rounded-2xl transition-opacity duration-500 blur-xl\"></div>\n                \n                <div className=\"relative text-center\">\n                  <div className=\"inline-flex items-center justify-center w-20 h-20 bg-gradient-to-r from-purple-500 to-pink-500 rounded-2xl shadow-lg group-hover:shadow-purple-500/50 transition-all duration-500 group-hover:scale-110 mb-6\">\n                    <Upload className=\"w-10 h-10 text-white\" />\n                  </div>\n                  <h3 className=\"text-2xl font-bold text-white mb-4\">æ–‡ä»¶ä¸Šä¼ </h3>\n                  <p className=\"text-blue-200/80 mb-6\">\n                    ç›´æ¥ä¸Šä¼ å›¾ç‰‡æˆ–è§†é¢‘æ–‡ä»¶è¿›è¡Œç‰ˆæƒæ³¨å†Œå’Œèµ„äº§åŒ–å¤„ç†\n                  </p>\n                  \n                  <div className=\"flex items-center justify-center space-x-6 text-sm text-blue-300/80\">\n                    <div className=\"flex items-center\">\n                      <FileImage className=\"h-5 w-5 mr-2\" />\n                      å›¾ç‰‡èµ„äº§\n                    </div>\n                    <div className=\"flex items-center\">\n                      <Video className=\"h-5 w-5 mr-2\" />\n                      è§†é¢‘èµ„äº§\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              <div \n                className=\"group relative bg-slate-800/50 backdrop-blur-sm border border-blue-500/20 rounded-2xl p-8 hover:border-blue-400/40 transition-all duration-500 hover:scale-105 cursor-pointer\"\n                onClick={() => setContentType('social-link')}\n              >\n                {/* Glow effect */}\n                <div className=\"absolute inset-0 bg-gradient-to-r from-blue-500/10 to-cyan-500/10 opacity-0 group-hover:opacity-100 rounded-2xl transition-opacity duration-500 blur-xl\"></div>\n                \n                <div className=\"relative text-center\">\n                  <div className=\"inline-flex items-center justify-center w-20 h-20 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-2xl shadow-lg group-hover:shadow-blue-500/50 transition-all duration-500 group-hover:scale-110 mb-6\">\n                    <Link2 className=\"w-10 h-10 text-white\" />\n                  </div>\n                  <h3 className=\"text-2xl font-bold text-white mb-4\">ç¤¾äº¤åª’ä½“é“¾æ¥</h3>\n                  <p className=\"text-blue-200/80 mb-6\">\n                    è¾“å…¥æŠ–éŸ³ã€å°çº¢ä¹¦ã€Instagramç­‰å¹³å°çš„å†…å®¹é“¾æ¥è¿›è¡Œèµ„äº§åŒ–\n                  </p>\n                  \n                  <div className=\"flex items-center justify-center space-x-4 text-sm text-blue-300/80\">\n                    <span className=\"flex items-center\">\n                      ğŸµ <span className=\"ml-1\">æŠ–éŸ³</span>\n                    </span>\n                    <span className=\"flex items-center\">\n                      ğŸ“± <span className=\"ml-1\">å°çº¢ä¹¦</span>\n                    </span>\n                    <span className=\"flex items-center\">\n                      ğŸ“· <span className=\"ml-1\">Instagram</span>\n                    </span>\n                  </div>\n                </div>\n              </div>\n            </div>\n          ) : (\n            <div className=\"max-w-2xl mx-auto\">\n              <div className=\"bg-slate-800/50 backdrop-blur-sm border border-blue-500/20 rounded-2xl overflow-hidden\">\n                <div className=\"p-6 border-b border-blue-500/20\">\n                  <h3 className=\"flex items-center text-xl font-bold text-white\">\n                    {contentType === 'file' ? (\n                      <>\n                        <Upload className=\"h-6 w-6 mr-3 text-purple-400\" />\n                        æ–‡ä»¶ä¸Šä¼ \n                      </>\n                    ) : (\n                      <>\n                        <Link2 className=\"h-6 w-6 mr-3 text-blue-400\" />\n                        ç¤¾äº¤åª’ä½“é“¾æ¥\n                      </>\n                    )}\n                  </h3>\n                  <p className=\"text-blue-200/70 mt-2\">\n                    {contentType === 'file' \n                      ? 'ä¸Šä¼ ä½ çš„åˆ›ä½œæ–‡ä»¶å¹¶å¡«å†™åŸºæœ¬ä¿¡æ¯ï¼Œå¼€å¯èµ„äº§åŒ–ä¹‹æ—…' \n                      : 'è¾“å…¥ç¤¾äº¤åª’ä½“å†…å®¹é“¾æ¥ï¼Œç³»ç»Ÿå°†è‡ªåŠ¨è§£æå¹¶è¯„ä¼°æ•°æ®ä»·å€¼'\n                    }\n                  </p>\n                </div>\n                \n                <div className=\"p-6 space-y-6\">\n                  {contentType === 'file' ? (\n                    <div>\n                      <label className=\"block text-sm font-medium text-blue-200 mb-3\">\n                        é€‰æ‹©æ–‡ä»¶\n                      </label>\n                      <div className=\"relative border-2 border-dashed border-blue-500/30 rounded-xl p-8 text-center hover:border-blue-400/50 transition-colors duration-300\">\n                        <input\n                          type=\"file\"\n                          accept=\"image/*,video/*\"\n                          onChange={handleFileUpload}\n                          className=\"hidden\"\n                          id=\"file-upload\"\n                        />\n                        <label htmlFor=\"file-upload\" className=\"cursor-pointer\">\n                          {file ? (\n                            <div>\n                              <FileImage className=\"h-16 w-16 text-green-400 mx-auto mb-4\" />\n                              <p className=\"text-white font-medium\">{file.name}</p>\n                              <p className=\"text-blue-300/70 text-sm mt-2\">ç‚¹å‡»é‡æ–°é€‰æ‹©æ–‡ä»¶</p>\n                            </div>\n                          ) : (\n                            <div>\n                              <Upload className=\"h-16 w-16 text-blue-400 mx-auto mb-4\" />\n                              <p className=\"text-blue-200 mb-2\">ç‚¹å‡»é€‰æ‹©æ–‡ä»¶æˆ–æ‹–æ‹½åˆ°æ­¤å¤„</p>\n                              <p className=\"text-blue-300/70 text-sm\">æ”¯æŒ JPG, PNG, MP4, MOV ç­‰æ ¼å¼</p>\n                            </div>\n                          )}\n                        </label>\n                        {/* Glow effect */}\n                        <div className=\"absolute inset-0 bg-gradient-to-r from-blue-500/10 to-purple-500/10 rounded-xl opacity-0 hover:opacity-100 transition-opacity duration-300 blur-xl pointer-events-none\"></div>\n                      </div>\n                    </div>\n                  ) : (\n                    <div>\n                      <label className=\"block text-sm font-medium text-blue-200 mb-3\">\n                        å†…å®¹é“¾æ¥\n                      </label>\n                      <input\n                        type=\"url\"\n                        placeholder=\"https://www.douyin.com/video/...\"\n                        value={socialUrl}\n                        onChange={(e) => setSocialUrl(e.target.value)}\n                        className=\"w-full px-4 py-3 bg-slate-700/50 border border-blue-500/30 rounded-xl text-white placeholder-blue-300/50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300\"\n                      />\n                      <p className=\"text-blue-300/70 text-sm mt-2\">\n                        æ”¯æŒæŠ–éŸ³ã€å°çº¢ä¹¦ã€Instagramã€å¾®åšç­‰å¹³å°é“¾æ¥\n                      </p>\n                    </div>\n                  )}\n\n                  <div>\n                    <label className=\"block text-sm font-medium text-blue-200 mb-3\">\n                      å†…å®¹æ ‡é¢˜ *\n                    </label>\n                    <input\n                      type=\"text\"\n                      placeholder=\"ç»™ä½ çš„æ•°å­—èµ„äº§èµ·ä¸ªæ ‡é¢˜\"\n                      value={title}\n                      onChange={(e) => setTitle(e.target.value)}\n                      className=\"w-full px-4 py-3 bg-slate-700/50 border border-blue-500/30 rounded-xl text-white placeholder-blue-300/50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300\"\n                      required\n                    />\n                  </div>\n\n                  <div>\n                    <label className=\"block text-sm font-medium text-blue-200 mb-3\">\n                      å†…å®¹æè¿°\n                    </label>\n                    <textarea\n                      placeholder=\"æè¿°ä¸€ä¸‹ä½ çš„æ•°å­—èµ„äº§ç‰¹ç‚¹ï¼ˆå¯é€‰ï¼‰\"\n                      value={description}\n                      onChange={(e) => setDescription(e.target.value)}\n                      rows={3}\n                      className=\"w-full px-4 py-3 bg-slate-700/50 border border-blue-500/30 rounded-xl text-white placeholder-blue-300/50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300 resize-none\"\n                    />\n                  </div>\n\n                  <div className=\"flex space-x-4 pt-4\">\n                    <Button\n                      variant=\"outline\"\n                      onClick={() => setContentType(null)}\n                      className=\"flex-1 bg-slate-700/50 hover:bg-slate-600/50 text-blue-300 hover:text-white border-blue-500/30 hover:border-blue-400/50\"\n                    >\n                      è¿”å›é€‰æ‹©\n                    </Button>\n                    <Button\n                      onClick={contentType === 'file' ? handleFileSubmit : handleSocialUrlSubmit}\n                      disabled={\n                        isProcessing || \n                        !title.trim() || \n                        (contentType === 'file' && !file) || \n                        (contentType === 'social-link' && !socialUrl.trim())\n                      }\n                      className=\"flex-1 bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-700 hover:to-cyan-700 text-white shadow-lg hover:shadow-blue-500/25 transition-all duration-300 hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100\"\n                    >\n                      {isProcessing ? (\n                        <>\n                          <Zap className=\"w-4 h-4 mr-2 animate-spin\" />\n                          å¤„ç†ä¸­...\n                        </>\n                      ) : (\n                        'ä¸‹ä¸€æ­¥ï¼šAIæˆæƒè®¾ç½®'\n                      )}\n                    </Button>\n                  </div>\n                </div>\n              </div>\n            </div>\n          )}\n        </div>\n      </main>\n    </div>\n  )\n}"